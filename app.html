<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mythras Classic Fantasy Character Sheet</title>
  <script>
    // Auth check - redirect to login if not authenticated
    (function() {
      const SESSION_HOURS = 24;
      const authData = localStorage.getItem('mythras_auth');
      if (!authData) {
        window.location.href = 'index.html';
        return;
      }
      try {
        const { timestamp } = JSON.parse(authData);
        const hoursSinceLogin = (Date.now() - timestamp) / (1000 * 60 * 60);
        if (hoursSinceLogin >= SESSION_HOURS) {
          localStorage.removeItem('mythras_auth');
          window.location.href = 'index.html';
        }
      } catch (e) {
        localStorage.removeItem('mythras_auth');
        window.location.href = 'index.html';
      }
    })();
  </script>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/theme.css">
  <link rel="stylesheet" href="css/print.css" media="print">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
</head>
<body>
  <div id="app" class="character-sheet" data-sheet-type="human">
    
    <!-- Navigation Tabs -->
    <nav class="sheet-navigation no-print">
      <ul class="tab-list">
        <li><button class="tab-btn" data-page="portrait">Portrait</button></li>
        <li><button class="tab-btn active" data-page="main">Character</button></li>
        <li><button class="tab-btn" data-page="combat">Combat</button></li>
        <li><button class="tab-btn" data-page="magic1">Magic 1-2</button></li>
        <li><button class="tab-btn" data-page="magic2">Magic 3-5</button></li>
        <li><button class="tab-btn" data-page="notes">Notes</button></li>
      </ul>
      <div class="sheet-controls">
        <select id="sheet-type-select" class="sheet-type-selector">
          <option value="human">Human / Demihuman</option>
          <option value="syrin">Syrin</option>
        </select>
        <button id="btn-save" class="btn btn-primary">Save</button>
        <button id="btn-load" class="btn btn-secondary">Load</button>
        <button id="btn-export" class="btn btn-secondary">Export JSON</button>
        <button id="btn-print" class="btn btn-secondary">Print</button>
        <button id="btn-logout" class="btn btn-secondary">Logout</button>
      </div>
    </nav>

    <!-- ==================== PAGE 1: PORTRAIT ==================== -->
    <section id="page-portrait" class="sheet-page page-portrait">
      <div class="portrait-frame ornate-border">
        <div class="portrait-container full-body-portrait">
          <input type="file" id="full-body-upload" accept="image/*" class="image-upload-input">
          <label for="full-body-upload" class="image-upload-label">
            <span class="upload-text">Click Here</span>
            <span class="upload-subtext">to add a full body image of your character.</span>
          </label>
          <img id="full-body-image" class="portrait-image hidden" alt="Character full body portrait">
          <button class="btn-remove-image hidden" data-target="full-body">Ã—</button>
        </div>
      </div>
    </section>

    <!-- ==================== PAGE 2: MAIN CHARACTER SHEET ==================== -->
    <section id="page-main" class="sheet-page page-main active">
      <div class="page-content ornate-border">
        
        <!-- Header Row -->
        <header class="sheet-header">
          <div class="header-left">
            <div class="field-row">
              <label class="field-label field-label-large">Character</label>
              <input type="text" id="character-name" class="field-input field-input-large" placeholder="">
            </div>
            <div class="field-row">
              <label class="field-label">Species/Culture</label>
              <input type="text" id="species" class="field-input field-input-half" placeholder="">
              <span class="field-separator">/</span>
              <input type="text" id="culture" class="field-input field-input-half" placeholder="">
            </div>
            <div class="field-row">
              <label class="field-label">Class</label>
              <input type="text" id="class-primary" class="field-input field-input-third" placeholder="">
              <span class="field-separator">/</span>
              <input type="text" id="class-secondary" class="field-input field-input-third" placeholder="">
              <span class="field-separator">/</span>
              <input type="text" id="class-tertiary" class="field-input field-input-third" placeholder="">
            </div>
            <div class="field-row">
              <label class="field-label">Rank Name</label>
              <input type="text" id="rank-name" class="field-input" placeholder="">
            </div>
            <div class="field-row">
              <label class="field-label">Gender</label>
              <input type="text" id="gender" class="field-input" placeholder="">
            </div>
            <div class="field-row">
              <label class="field-label">Age</label>
              <input type="number" id="age" class="field-input field-input-small" placeholder="">
              <label class="field-label">Handedness</label>
              <input type="text" id="handedness" class="field-input field-input-small" placeholder="">
            </div>
          </div>
          
          <div class="header-center">
            <div class="field-row">
              <label class="field-label">Height</label>
              <input type="text" id="height" class="field-input field-input-small" placeholder="5' 10&quot;">
            </div>
            <div class="field-row">
              <label class="field-label">Weight</label>
              <input type="number" id="weight" class="field-input field-input-small" placeholder="">
              <span class="field-suffix">Lb.</span>
            </div>
            <div class="field-row">
              <label class="field-label">Hair</label>
              <input type="text" id="hair" class="field-input" placeholder="">
            </div>
            <div class="field-row">
              <label class="field-label">Eyes</label>
              <input type="text" id="eyes" class="field-input" placeholder="">
            </div>
            <div class="prereq-skills">
              <div class="prereq-row">
                <span class="prereq-icon">ðŸ”´</span>
                <span class="prereq-label">Class Prereq. Skill</span>
              </div>
              <div class="prereq-row">
                <span class="prereq-icon">ðŸŸ¡</span>
                <span class="prereq-label">Subclass 1 Prereq. Skill</span>
              </div>
              <div class="prereq-row">
                <span class="prereq-icon">ðŸŸ¢</span>
                <span class="prereq-label">Subclass 2 Prereq. Skill</span>
              </div>
            </div>
          </div>
          
          <div class="header-right">
            <div class="rank-section">
              <h3 class="section-header">Rank(s)</h3>
              <div class="rank-row">
                <label class="field-label">Primary Class</label>
                <input type="number" id="rank-primary" class="field-input field-input-tiny" placeholder="">
              </div>
              <div class="rank-row">
                <label class="field-label">2nd</label>
                <input type="number" id="rank-secondary" class="field-input field-input-tiny" placeholder="">
                <label class="field-label">3rd</label>
                <input type="number" id="rank-tertiary" class="field-input field-input-tiny" placeholder="">
              </div>
            </div>
            <div class="tenacity-section">
              <label class="field-label">Tenacity Points</label>
              <input type="number" id="tenacity-max" class="field-input field-input-tiny derived-readonly" readonly>
              <span class="field-separator">/</span>
              <input type="number" id="tenacity-current" class="field-input field-input-tiny" placeholder="">
            </div>
            <div class="exp-rolls-section">
              <label class="field-label">EXP Rolls</label>
              <input type="number" id="exp-rolls" class="field-input field-input-small" placeholder="">
            </div>
          </div>
          
          <div class="header-logo">
            <div class="logo-mythras">
              <span class="logo-text">Mythras</span>
              <span class="logo-subtext">Classic Fantasy</span>
            </div>
            <div class="portrait-thumbnail">
              <input type="file" id="portrait-upload" accept="image/*" class="image-upload-input">
              <label for="portrait-upload" class="image-upload-label thumbnail-label">
                <span class="upload-text-small">Click Here</span>
                <span class="upload-subtext-small">to add a portrait</span>
              </label>
              <img id="portrait-image" class="portrait-image-thumb hidden" alt="Character portrait">
              <button class="btn-remove-image hidden" data-target="portrait">Ã—</button>
            </div>
          </div>
        </header>

        <!-- Main Content Grid -->
        <div class="main-content-grid">
          
          <!-- Left Column: Attributes & Skills -->
          <div class="column-left">
            
            <!-- Attributes Row - Two boxes side by side -->
            <div class="attributes-row">
              <!-- Core Attributes Box -->
              <section class="attributes-section core-attributes">
                <h3 class="section-header">Characteristics</h3>
                <div class="attribute-row">
                  <label class="attribute-label">STR</label>
                  <input type="number" id="str-value" class="attribute-input" data-attr="STR" placeholder="">
                </div>
                <div class="attribute-row">
                  <label class="attribute-label">CON</label>
                  <input type="number" id="con-value" class="attribute-input" data-attr="CON" placeholder="">
                </div>
                <div class="attribute-row">
                  <label class="attribute-label">SIZ</label>
                  <input type="number" id="siz-value" class="attribute-input" data-attr="SIZ" placeholder="">
                </div>
                <div class="attribute-row">
                  <label class="attribute-label">DEX</label>
                  <input type="number" id="dex-value" class="attribute-input" data-attr="DEX" placeholder="">
                </div>
                <div class="attribute-row">
                  <label class="attribute-label">INT</label>
                  <input type="number" id="int-value" class="attribute-input" data-attr="INT" placeholder="">
                </div>
                <div class="attribute-row">
                  <label class="attribute-label">POW</label>
                  <input type="number" id="pow-value" class="attribute-input" data-attr="POW" placeholder="">
                </div>
                <div class="attribute-row">
                  <label class="attribute-label">CHA</label>
                  <input type="number" id="cha-value" class="attribute-input" data-attr="CHA" placeholder="">
                </div>
                <div class="movement-row">
                  <span class="movement-label">Movement</span>
                  <input type="number" id="movement-base" class="movement-input" placeholder="20">
                </div>
              </section>
              
              <!-- Derived Attributes Box -->
              <section class="attributes-section derived-attributes">
                <h3 class="section-header">Attributes</h3>
                <div class="derived-row">
                  <span class="derived-label">Action Points</span>
                  <input type="number" id="action-points-original" class="derived-input derived-readonly" readonly>
                  <input type="number" id="action-points-current" class="derived-input" placeholder="">
                </div>
                <div class="derived-row">
                  <span class="derived-label">Damage Mod</span>
                  <input type="text" id="damage-mod-original" class="derived-input derived-readonly" readonly>
                  <input type="text" id="damage-mod-current" class="derived-input" placeholder="">
                </div>
                <div class="derived-row">
                  <span class="derived-label">Exp Mod</span>
                  <input type="number" id="exp-mod-original" class="derived-input derived-readonly" readonly>
                  <input type="number" id="exp-mod-current" class="derived-input" placeholder="">
                </div>
                <div class="derived-row">
                  <span class="derived-label">Healing Rate</span>
                  <input type="number" id="healing-rate-original" class="derived-input derived-readonly" readonly>
                  <input type="number" id="healing-rate-current" class="derived-input" placeholder="">
                </div>
                <div class="derived-row">
                  <span class="derived-label">Initiative</span>
                  <input type="number" id="initiative-original" class="derived-input derived-readonly" readonly>
                  <input type="number" id="initiative-current" class="derived-input" placeholder="">
                </div>
                <div class="derived-row">
                  <span class="derived-label">Luck Points</span>
                  <input type="number" id="luck-original" class="derived-input derived-readonly" readonly>
                  <input type="number" id="luck-current" class="derived-input" placeholder="">
                </div>
                <div class="derived-row">
                  <span class="derived-label">Magic Points</span>
                  <input type="number" id="magic-points-original" class="derived-input derived-readonly" readonly>
                  <input type="number" id="magic-points-current" class="derived-input" placeholder="">
                </div>
                <button type="button" id="edit-derived-btn" class="btn btn-small btn-secondary">Edit Original Values</button>
              </section>
            </div>

            <!-- Standard Skills Section -->
            <section class="skills-section standard-skills">
              <h3 class="section-header">Standard Skills</h3>
              <div class="skills-header">
                <span></span>
                <span></span>
                <span class="header-base">Base %</span>
                <span class="header-current">%</span>
                <span></span>
              </div>
              
              <div class="skill-row" data-skill="athletics">
                <span class="skill-name">Athletics</span>
                <span class="skill-formula">STR+DEX</span>
                <span class="skill-base" id="athletics-base">0</span>
                <input type="number" id="athletics-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="boating">
                <span class="skill-name">Boating</span>
                <span class="skill-formula">STR+CON</span>
                <span class="skill-base" id="boating-base">0</span>
                <input type="number" id="boating-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="brawn">
                <span class="skill-name">Brawn</span>
                <span class="skill-formula">STR+SIZ</span>
                <span class="skill-base" id="brawn-base">0</span>
                <input type="number" id="brawn-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="conceal">
                <span class="skill-name">Conceal</span>
                <span class="skill-formula">DEX+POW</span>
                <span class="skill-base" id="conceal-base">0</span>
                <input type="number" id="conceal-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="customs">
                <span class="skill-name">Customs</span>
                <span class="skill-formula">INT x2+40</span>
                <span class="skill-base" id="customs-base">0</span>
                <input type="number" id="customs-current" class="skill-input" placeholder="">
              </div>
              
              <div class="skill-row" data-skill="dance">
                <span class="skill-name">Dance</span>
                <span class="skill-formula">DEX+CHA</span>
                <span class="skill-base" id="dance-base">0</span>
                <input type="number" id="dance-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="deceit">
                <span class="skill-name">Deceit</span>
                <span class="skill-formula">INT+CHA</span>
                <span class="skill-base" id="deceit-base">0</span>
                <input type="number" id="deceit-current" class="skill-input" placeholder="">
              </div>
              
              <div class="skill-row" data-skill="drive">
                <span class="skill-name">Drive</span>
                <span class="skill-formula">DEX+POW</span>
                <span class="skill-base" id="drive-base">0</span>
                <input type="number" id="drive-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="endurance">
                <span class="skill-name">Endurance</span>
                <span class="skill-formula">CON x2</span>
                <span class="skill-base" id="endurance-base">0</span>
                <input type="number" id="endurance-current" class="skill-input" placeholder="">
              </div>
              
              <div class="skill-row" data-skill="evade">
                <span class="skill-name">Evade</span>
                <span class="skill-formula">DEX x2</span>
                <span class="skill-base" id="evade-base">0</span>
                <input type="number" id="evade-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="first-aid">
                <span class="skill-name">First Aid</span>
                <span class="skill-formula">INT+DEX</span>
                <span class="skill-base" id="first-aid-base">0</span>
                <input type="number" id="first-aid-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="influence">
                <span class="skill-name">Influence</span>
                <span class="skill-formula">CHA x2</span>
                <span class="skill-base" id="influence-base">0</span>
                <input type="number" id="influence-current" class="skill-input" placeholder="">
              </div>
              
              <div class="skill-row" data-skill="insight">
                <span class="skill-name">Insight</span>
                <span class="skill-formula">INT+POW</span>
                <span class="skill-base" id="insight-base">0</span>
                <input type="number" id="insight-current" class="skill-input" placeholder="">
              </div>
              
              <div class="skill-row" data-skill="locale">
                <span class="skill-name">Locale</span>
                <span class="skill-formula">INT x2</span>
                <span class="skill-base" id="locale-base">0</span>
                <input type="number" id="locale-current" class="skill-input" placeholder="">
              </div>
              
              <div class="skill-row" data-skill="perception">
                <span class="skill-name">Perception</span>
                <span class="skill-formula">INT+POW</span>
                <span class="skill-base" id="perception-base">0</span>
                <input type="number" id="perception-current" class="skill-input" placeholder="">
              </div>
              
              <div class="skill-row" data-skill="ride">
                <span class="skill-name">Ride</span>
                <span class="skill-formula">DEX+POW</span>
                <span class="skill-base" id="ride-base">0</span>
                <input type="number" id="ride-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="sing">
                <span class="skill-name">Sing</span>
                <span class="skill-formula">CHA+POW</span>
                <span class="skill-base" id="sing-base">0</span>
                <input type="number" id="sing-current" class="skill-input" placeholder="">
              </div>
              
              <div class="skill-row" data-skill="stealth">
                <span class="skill-name">Stealth</span>
                <span class="skill-formula">DEX+INT</span>
                <span class="skill-base" id="stealth-base">0</span>
                <input type="number" id="stealth-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="swim">
                <span class="skill-name">Swim</span>
                <span class="skill-formula">STR+CON</span>
                <span class="skill-base" id="swim-base">0</span>
                <input type="number" id="swim-current" class="skill-input" placeholder="">
                <span class="enc-indicator" title="Affected by ENC"></span>
              </div>
              
              <div class="skill-row" data-skill="willpower">
                <span class="skill-name">Willpower</span>
                <span class="skill-formula">POW x2</span>
                <span class="skill-base" id="willpower-base">0</span>
                <input type="number" id="willpower-current" class="skill-input" placeholder="">
              </div>
            </section>

            <!-- ENC Penalty Note -->
            <div class="enc-penalty-note">
              <span class="enc-indicator"></span>
              <span>= ENC Penalty</span>
            </div>

            <!-- Skill Grade Reference -->
            <section class="skill-grade-reference">
              <h3 class="section-header">Skill Grade</h3>
              <div class="grade-table">
                <div class="grade-row"><span>Automatic</span><span>â€“</span></div>
                <div class="grade-row"><span>Very Easy</span><span>+40%</span></div>
                <div class="grade-row"><span>Easy</span><span>+20%</span></div>
                <div class="grade-row"><span>Standard</span><span>â€“</span></div>
                <div class="grade-row"><span>Hard</span><span>-20%</span></div>
                <div class="grade-row"><span>Formidable</span><span>-40%</span></div>
                <div class="grade-row"><span>Herculean</span><span>-80%</span></div>
                <div class="grade-row"><span>Hopeless</span><span>â€“</span></div>
              </div>
            </section>
          </div>

          <!-- Center Column: Alignment, Passion, Oath, Professional Skills, Languages -->
          <div class="column-center">
            
            <!-- Alignment Section -->
            <section class="alignment-section">
              <h3 class="section-header">Alignment</h3>
              <div class="section-subheader">
                <span></span>
                <span></span>
                <span class="header-base">Base %</span>
                <span class="header-current">%</span>
              </div>
              <div class="belief-row">
                <input type="text" class="belief-name" id="alignment-1-name" placeholder="">
                <span class="belief-formula">POW+INT+50</span>
                <span class="belief-base" id="alignment-1-base">0</span>
                <input type="number" class="belief-input" id="alignment-1-current" placeholder="">
              </div>
              <div class="belief-row">
                <input type="text" class="belief-name" id="alignment-2-name" placeholder="">
                <span class="belief-formula">POW+INT+50</span>
                <span class="belief-base" id="alignment-2-base">0</span>
                <input type="number" class="belief-input" id="alignment-2-current" placeholder="">
              </div>
            </section>

            <!-- Passion Section -->
            <section class="passion-section">
              <h3 class="section-header">Passions</h3>
              <div class="section-subheader">
                <span></span>
                <span></span>
                <span class="header-base">Base %</span>
                <span class="header-current">%</span>
              </div>
              <div class="belief-row" data-index="1">
                <input type="text" class="belief-name" id="passion-1-name" placeholder="">
                <span class="belief-formula">POW+INT+50</span>
                <span class="belief-base" id="passion-1-base">0</span>
                <input type="number" class="belief-input" id="passion-1-current" placeholder="">
              </div>
              <div class="belief-row" data-index="2">
                <input type="text" class="belief-name" id="passion-2-name" placeholder="">
                <span class="belief-formula">POW+INT+50</span>
                <span class="belief-base" id="passion-2-base">0</span>
                <input type="number" class="belief-input" id="passion-2-current" placeholder="">
              </div>
              <div class="belief-row" data-index="3">
                <input type="text" class="belief-name" id="passion-3-name" placeholder="">
                <span class="belief-formula">POW+INT+50</span>
                <span class="belief-base" id="passion-3-base">0</span>
                <input type="number" class="belief-input" id="passion-3-current" placeholder="">
              </div>
              <div class="belief-row" data-index="4">
                <input type="text" class="belief-name" id="passion-4-name" placeholder="">
                <span class="belief-formula">POW+INT+50</span>
                <span class="belief-base" id="passion-4-base">0</span>
                <input type="number" class="belief-input" id="passion-4-current" placeholder="">
              </div>
            </section>

            <!-- Oath Section -->
            <section class="oath-section">
              <h3 class="section-header">Oaths</h3>
              <div class="section-subheader">
                <span></span>
                <span></span>
                <span class="header-base">Base %</span>
                <span class="header-current">%</span>
              </div>
              <div class="belief-row" data-index="1">
                <input type="text" class="belief-name" id="oath-1-name" placeholder="">
                <span class="belief-formula">POW+CHA+50</span>
                <span class="belief-base" id="oath-1-base">0</span>
                <input type="number" class="belief-input" id="oath-1-current" placeholder="">
              </div>
              <div class="belief-row" data-index="2">
                <input type="text" class="belief-name" id="oath-2-name" placeholder="">
                <span class="belief-formula">POW+CHA+50</span>
                <span class="belief-base" id="oath-2-base">0</span>
                <input type="number" class="belief-input" id="oath-2-current" placeholder="">
              </div>
              <div class="belief-row" data-index="3">
                <input type="text" class="belief-name" id="oath-3-name" placeholder="">
                <span class="belief-formula">POW+CHA+50</span>
                <span class="belief-base" id="oath-3-base">0</span>
                <input type="number" class="belief-input" id="oath-3-current" placeholder="">
              </div>
              <div class="belief-row" data-index="4">
                <input type="text" class="belief-name" id="oath-4-name" placeholder="">
                <span class="belief-formula">POW+CHA+50</span>
                <span class="belief-base" id="oath-4-base">0</span>
                <input type="number" class="belief-input" id="oath-4-current" placeholder="">
              </div>
            </section>

            <!-- Professional Skills Section -->
            <section class="skills-section professional-skills">
              <h3 class="section-header">Professional Skills</h3>
              <div class="skills-header prof-header">
                <span></span>
                <span></span>
                <span class="header-base">Base %</span>
                <span class="header-current">%</span>
              </div>
              <div id="professional-skills-container">
                <!-- Professional skills are dynamically generated -->
              </div>
            </section>

            <!-- Language Section -->
            <section class="language-section">
              <h3 class="section-header">Language</h3>
              <div class="section-subheader">
                <span></span>
                <span></span>
                <span class="header-base">Base %</span>
                <span class="header-current">%</span>
              </div>
              <div class="language-row native">
                <label class="language-label">Native Tongue:</label>
                <input type="text" class="language-name" id="native-tongue-name" placeholder="">
                <span class="language-formula">INT+CHA+40</span>
                <span class="language-base" id="native-tongue-base">0</span>
                <input type="number" class="language-input" id="native-tongue-current" placeholder="">
              </div>
              <div class="language-row">
                <input type="text" class="language-name" id="language-2-name" placeholder="">
                <span class="language-formula">INT+CHA</span>
                <span class="language-base" id="language-2-base">0</span>
                <input type="number" class="language-input" id="language-2-current" placeholder="">
              </div>
              <div class="language-row">
                <input type="text" class="language-name" id="language-3-name" placeholder="">
                <span class="language-formula">INT+CHA</span>
                <span class="language-base" id="language-3-base">0</span>
                <input type="number" class="language-input" id="language-3-current" placeholder="">
              </div>
              <div class="language-row">
                <input type="text" class="language-name" id="language-4-name" placeholder="">
                <span class="language-formula">INT+CHA</span>
                <span class="language-base" id="language-4-base">0</span>
                <input type="number" class="language-input" id="language-4-current" placeholder="">
              </div>
              <div class="language-row">
                <input type="text" class="language-name" id="language-5-name" placeholder="">
                <span class="language-formula">INT+CHA</span>
                <span class="language-base" id="language-5-base">0</span>
                <input type="number" class="language-input" id="language-5-current" placeholder="">
              </div>
            </section>
          </div>

          <!-- Right Column: Equipment -->
          <div class="column-right">
            <section class="equipment-section">
              <h3 class="section-header">Equipment</h3>
              <div class="equipment-header">
                <span class="header-item">Item</span>
                <span class="header-enc">ENC</span>
              </div>
              <div id="equipment-container" class="equipment-scrollable">
                <!-- Equipment rows are dynamically generated -->
              </div>
              <div class="enc-totals">
                <div class="enc-toggle">
                  <label>
                    <input type="checkbox" id="enc-automation-toggle">
                    <span>Toggle ENC Automation (Check=OFF)</span>
                  </label>
                </div>
                <div class="enc-status-row">
                  <span class="enc-status-label">Current ENC Status:</span>
                  <span class="enc-status-value" id="enc-status">Unburdened</span>
                </div>
                <div class="enc-total-row">
                  <span class="enc-total-label">Total ENC:</span>
                  <span class="enc-total-value" id="total-enc">0.0</span>
                </div>
              </div>
            </section>
            
            <!-- Backpack Button -->
            <button type="button" class="btn btn-backpack" id="btn-open-backpack">
              Backpack
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Backpack Modal Overlay -->
    <div id="backpack-modal" class="modal-overlay hidden">
      <div class="modal-content backpack-modal">
        <div class="modal-header">
          <h3>Backpack Contents</h3>
          <button type="button" class="btn-modal-close" id="btn-close-backpack">&times;</button>
        </div>
        <div class="modal-body">
          <div class="equipment-header">
            <span class="header-item">Item</span>
            <span class="header-enc">ENC</span>
          </div>
          <div id="backpack-container">
            <!-- Backpack rows are dynamically generated -->
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" id="btn-save-backpack">Save & Close</button>
        </div>
      </div>
    </div>

    <!-- ==================== PAGE 3: COMBAT ==================== -->
    <section id="page-combat" class="sheet-page page-combat">
      <div class="page-content ornate-border">
        <h2 class="page-title">COMBAT</h2>
        
        <!-- Quick Reference Section -->
        <div class="combat-header-grid">
          <div class="quick-reference">
            <h3 class="section-header">Quick Reference Combat Attributes</h3>
            <div class="quick-ref-row">
              <div class="quick-ref-item">
                <span class="ref-label">Initiative (C)</span>
                <span class="ref-value" id="combat-initiative"></span>
              </div>
              <div class="quick-ref-item">
                <span class="ref-label">Luck Points (C)</span>
                <span class="ref-value" id="combat-luck"></span>
              </div>
              <div class="quick-ref-item">
                <span class="ref-label">Combat Skill</span>
                <span class="ref-value" id="combat-skill-ref"></span>
              </div>
              <div class="quick-ref-item">
                <span class="ref-label">Action Points (C)</span>
                <span class="ref-value" id="combat-action-points"></span>
              </div>
            </div>
            <div class="quick-ref-skills">
              <div class="ref-skill-row">
                <div class="ref-skill-item" id="ref-athletics">
                  <span class="ref-skill-label">Athletics</span>
                  <span class="ref-skill-value"></span>
                </div>
                <div class="ref-skill-item" id="ref-brawn">
                  <span class="ref-skill-label">Brawn</span>
                  <span class="ref-skill-value"></span>
                </div>
                <div class="ref-skill-item" id="ref-endurance">
                  <span class="ref-skill-label">Endurance</span>
                  <span class="ref-skill-value"></span>
                </div>
                <div class="ref-skill-item" id="ref-evade">
                  <span class="ref-skill-label">Evade</span>
                  <span class="ref-skill-value"></span>
                </div>
              </div>
              <div class="ref-skill-row">
                <div class="ref-skill-item" id="ref-perception">
                  <span class="ref-skill-label">Perception</span>
                  <span class="ref-skill-value"></span>
                </div>
                <div class="ref-skill-item" id="ref-stealth">
                  <span class="ref-skill-label">Stealth</span>
                  <span class="ref-skill-value"></span>
                </div>
                <div class="ref-skill-item" id="ref-swim">
                  <span class="ref-skill-label">Swim</span>
                  <span class="ref-skill-value"></span>
                </div>
                <div class="ref-skill-item" id="ref-willpower">
                  <span class="ref-skill-label">Willpower</span>
                  <span class="ref-skill-value"></span>
                </div>
              </div>
            </div>
          </div>

          <!-- Hit Locations -->
          <div class="hit-locations">
            <h3 class="section-header">Hit Locations</h3>
            <table class="hit-location-table">
              <thead>
                <tr>
                  <th>1d20</th>
                  <th>Location</th>
                  <th>Armor</th>
                  <th>AP</th>
                  <th>HP/Crnt</th>
                </tr>
              </thead>
              <tbody id="hit-locations-body">
                <!-- Hit locations are populated based on sheet type -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Combat Skills Section -->
        <div class="combat-skills-section">
          <div class="combat-skill-header">
            <span class="header-label">Combat Skill</span>
            <span class="header-percent">%</span>
            <span class="header-weapons">Weapons Known</span>
            <span class="header-base">Base %</span>
          </div>
          <div class="combat-skill-row">
            <input type="text" class="combat-skill-name" id="combat-skill-1-name" placeholder="">
            <input type="number" class="combat-skill-percent" id="combat-skill-1-percent" placeholder="">
            <input type="text" class="combat-weapons-known" id="combat-skill-1-weapons" placeholder="">
            <span class="combat-base">STR+DEX</span>
          </div>
          <div class="combat-skill-row unarmed">
            <span class="combat-skill-name">Unarmed</span>
            <input type="number" class="combat-skill-percent" id="unarmed-percent" placeholder="">
            <span class="combat-weapons-known">Hands/Feet</span>
            <span class="combat-base">STR+DEX</span>
          </div>
        </div>

        <!-- Melee Weapons Table -->
        <section class="weapons-section melee-weapons">
          <h3 class="section-header">Melee Weapon</h3>
          <table class="weapons-table">
            <thead>
              <tr>
                <th>Melee Weapon</th>
                <th>Hands</th>
                <th>Damage</th>
                <th>Size</th>
                <th>Combat Special Effects</th>
                <th>AP/HP</th>
                <th>Weapon Traits</th>
              </tr>
            </thead>
            <tbody id="melee-weapons-body">
              <!-- 6 melee weapon rows -->
            </tbody>
          </table>
        </section>

        <!-- Ranged Weapons Table -->
        <section class="weapons-section ranged-weapons">
          <h3 class="section-header">Ranged Weapon</h3>
          <table class="weapons-table">
            <thead>
              <tr>
                <th>Ranged Weapon</th>
                <th>Hands</th>
                <th>Damage</th>
                <th>D.M.</th>
                <th>Range</th>
                <th>Load</th>
                <th>Special Effects</th>
                <th>Impl</th>
                <th>AP/HP</th>
                <th>Traits</th>
              </tr>
            </thead>
            <tbody id="ranged-weapons-body">
              <!-- 5 ranged weapon rows -->
            </tbody>
          </table>
        </section>

        <!-- Movement & Fatigue Grid -->
        <div class="movement-fatigue-grid">
          <!-- Movement Section -->
          <section class="movement-section">
            <h3 class="section-header">Movement</h3>
            <div class="movement-grid">
              <div class="movement-item">
                <span class="movement-type">Walk<br>(Base x1)</span>
                <span class="movement-value" id="walk-speed"></span>
              </div>
              <div class="movement-item">
                <span class="movement-type">Run<br>(Base x3)</span>
                <span class="movement-value" id="run-speed"></span>
              </div>
              <div class="movement-item">
                <span class="movement-type">Sprint<br>(Base x5)</span>
                <span class="movement-value" id="sprint-speed"></span>
              </div>
              <div class="movement-item">
                <span class="movement-type">Swim<br>(Base x1)</span>
                <span class="movement-value" id="swim-speed"></span>
              </div>
              <div class="movement-item">
                <span class="movement-type">Climb<br>(Base x1)</span>
                <span class="movement-value" id="climb-speed"></span>
              </div>
            </div>
            <div class="jump-grid">
              <div class="jump-item">
                <span class="jump-type">Vertical Jump<br>(1/2 Height)</span>
                <span class="jump-value" id="vertical-jump"></span>
              </div>
              <div class="jump-item">
                <span class="jump-type">Horizontal Jump<br>(2x Height)</span>
                <span class="jump-value" id="horizontal-jump"></span>
              </div>
              <div class="jump-item syrin-only">
                <span class="jump-type">Other Movement<br>(Flying)</span>
                <input type="text" class="jump-value-input" id="flying-speed" placeholder="">
              </div>
            </div>
          </section>

          <!-- Fatigue States Reference -->
          <section class="fatigue-section">
            <h3 class="section-header">Fatigue States</h3>
            <table class="fatigue-table">
              <thead>
                <tr>
                  <th>State</th>
                  <th>Skills</th>
                  <th>Movement</th>
                  <th>Initiative</th>
                  <th>AP</th>
                  <th>Recovery</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>Fresh</td><td>â€“</td><td>â€“</td><td>â€“</td><td>â€“</td><td>â€“</td></tr>
                <tr><td>Winded</td><td>Hard</td><td>â€“</td><td>â€“</td><td>â€“</td><td>15 min.</td></tr>
                <tr><td>Tired</td><td>Hard</td><td>-5 ft.</td><td>â€“</td><td>â€“</td><td>3 Hrs.</td></tr>
                <tr><td>Wearied</td><td>Formid.</td><td>-5 ft.</td><td>-2</td><td>â€“</td><td>6 Hrs.</td></tr>
                <tr><td>Exhausted</td><td>Formid.</td><td>1/2</td><td>-4</td><td>-1</td><td>12 Hrs.</td></tr>
                <tr><td>Debil</td><td>Herc.</td><td>1/2</td><td>-6</td><td>-2</td><td>18 Hrs.</td></tr>
                <tr><td>Incap.</td><td>Herc.</td><td>Immobile</td><td>-8</td><td>-3</td><td>24 Hrs.</td></tr>
                <tr><td>Semi-consc.</td><td>Hopeless</td><td>N/A</td><td>N/A</td><td>N/A</td><td>36 Hrs.</td></tr>
                <tr><td>Coma</td><td>N/A</td><td>N/A</td><td>N/A</td><td>N/A</td><td>48 Hrs.</td></tr>
              </tbody>
            </table>
          </section>
        </div>

        <!-- Special Abilities & Notes -->
        <div class="abilities-notes-grid">
          <section class="special-abilities-section">
            <h3 class="section-header">Special Ability</h3>
            <div class="abilities-columns">
              <div class="abilities-column" id="abilities-col-1">
                <!-- Special abilities column 1 -->
              </div>
              <div class="abilities-column" id="abilities-col-2">
                <!-- Special abilities column 2 -->
              </div>
              <div class="abilities-column" id="abilities-col-3">
                <!-- Special abilities column 3 -->
              </div>
            </div>
            <button class="btn btn-small" id="btn-sort-abilities">Click to alphabetize Special Abilities</button>
          </section>
          
          <section class="combat-notes-section">
            <h3 class="section-header">Notes</h3>
            <textarea id="combat-notes" class="notes-textarea" placeholder="Combat notes..."></textarea>
          </section>
        </div>
      </div>
    </section>

    <!-- ==================== PAGE 4: MAGIC (Cantrips, Rank 1-2) ==================== -->
    <section id="page-magic1" class="sheet-page page-magic">
      <div class="page-content ornate-border">
        <h2 class="page-title">MAGIC AND SPELLS</h2>
        
        <!-- Magic Skills Table -->
        <section class="magic-skills-section">
          <h3 class="section-header">Magic Skills</h3>
          <table class="magic-skills-table">
            <thead>
              <tr>
                <th>Class</th>
                <th>Casting Skill</th>
                <th>Base %</th>
                <th>%</th>
                <th>Knowl. Skill</th>
                <th>Base %</th>
                <th>%</th>
                <th>Deity</th>
              </tr>
            </thead>
            <tbody>
              <tr class="magic-class-divine">
                <td>Divine <span class="class-note">(Cleric, Ranger, Paladin, etc.)</span></td>
                <td>Channel</td>
                <td class="base-calc">INT+POW</td>
                <td><input type="number" id="channel-percent" class="magic-skill-input" placeholder=""></td>
                <td>Piety</td>
                <td class="base-calc">CHA+POW</td>
                <td><input type="number" id="piety-percent" class="magic-skill-input" placeholder=""></td>
                <td><input type="text" id="deity-name" class="deity-input" placeholder=""></td>
              </tr>
              <tr class="magic-class-mage human-only">
                <td>Mage</td>
                <td>Arcane Casting</td>
                <td class="base-calc">INT+POW</td>
                <td><input type="number" id="arcane-casting-percent" class="magic-skill-input" placeholder=""></td>
                <td>Arcane Knowledge</td>
                <td class="base-calc">INT x2</td>
                <td><input type="number" id="arcane-knowledge-percent" class="magic-skill-input" placeholder=""></td>
                <td></td>
              </tr>
              <tr class="magic-class-sorcerer human-only">
                <td>Sorcerer</td>
                <td>Arcane Sorcery</td>
                <td class="base-calc">CHA+POW</td>
                <td><input type="number" id="arcane-sorcery-percent" class="magic-skill-input" placeholder=""></td>
                <td>Sorcerous Wisdom</td>
                <td class="base-calc">CHA+INT</td>
                <td><input type="number" id="sorcerous-wisdom-percent" class="magic-skill-input" placeholder=""></td>
                <td></td>
              </tr>
              <tr class="magic-class-bard">
                <td>Bard</td>
                <td>Musicianship</td>
                <td class="base-calc">DEX+CHA</td>
                <td><input type="number" id="musicianship-percent" class="magic-skill-input" placeholder=""></td>
                <td>Lyrical Magic</td>
                <td class="base-calc">CHA+POW</td>
                <td><input type="number" id="lyrical-magic-percent" class="magic-skill-input" placeholder=""></td>
                <td></td>
              </tr>
            </tbody>
          </table>
          <p class="syrin-note syrin-only">Syrin may not become Mages or Sorcerers</p>
        </section>

        <!-- Spell Lists -->
        <div class="spell-columns">
          <!-- Cantrips -->
          <section class="spell-column cantrips">
            <h3 class="spell-rank-header">Cantrips</h3>
            <div class="memorize-count">
              May Memorize <input type="number" id="cantrips-max" class="memorize-input" value="0"> Spells
            </div>
            <table class="spell-table">
              <thead>
                <tr>
                  <th class="col-memorized">M</th>
                  <th class="col-spell">Spell</th>
                  <th class="col-cost">Cost</th>
                </tr>
              </thead>
              <tbody id="cantrips-body">
                <!-- Cantrip rows generated dynamically -->
              </tbody>
            </table>
          </section>

          <!-- Rank 1 Spells -->
          <section class="spell-column rank1">
            <h3 class="spell-rank-header">Rank 1 Spells</h3>
            <div class="memorize-count">
              May Memorize <input type="number" id="rank1-max" class="memorize-input" value="0"> Spells
            </div>
            <table class="spell-table">
              <thead>
                <tr>
                  <th class="col-memorized">M</th>
                  <th class="col-spell">Spell</th>
                  <th class="col-cost">Cost</th>
                </tr>
              </thead>
              <tbody id="rank1-body">
                <!-- Rank 1 spell rows generated dynamically -->
              </tbody>
            </table>
          </section>

          <!-- Rank 2 Spells -->
          <section class="spell-column rank2">
            <h3 class="spell-rank-header">Rank 2 Spells</h3>
            <div class="memorize-count">
              May Memorize <input type="number" id="rank2-max" class="memorize-input" value="0"> Spells
            </div>
            <table class="spell-table">
              <thead>
                <tr>
                  <th class="col-memorized">M</th>
                  <th class="col-spell">Spell</th>
                  <th class="col-cost">Cost</th>
                </tr>
              </thead>
              <tbody id="rank2-body">
                <!-- Rank 2 spell rows generated dynamically -->
              </tbody>
            </table>
          </section>
        </div>
      </div>
    </section>

    <!-- ==================== PAGE 5: MAGIC (Rank 3-5) ==================== -->
    <section id="page-magic2" class="sheet-page page-magic">
      <div class="page-content ornate-border">
        <h2 class="page-title">MAGIC AND SPELLS</h2>
        
        <!-- Magic Skills Table (Repeated for reference) -->
        <section class="magic-skills-section">
          <h3 class="section-header">Magic Skills</h3>
          <table class="magic-skills-table">
            <thead>
              <tr>
                <th>Class</th>
                <th>Casting Skill</th>
                <th>%</th>
                <th>Knowl. Skill</th>
                <th>Base %</th>
                <th>%</th>
                <th>Deity</th>
              </tr>
            </thead>
            <tbody>
              <tr class="magic-class-divine">
                <td>Divine <span class="class-note">(Cleric, Ranger, Paladin, etc.)</span></td>
                <td>Channel</td>
                <td class="magic-skill-ref" data-ref="channel-percent"></td>
                <td>Piety</td>
                <td class="base-calc">CHA+POW</td>
                <td class="magic-skill-ref" data-ref="piety-percent"></td>
                <td class="magic-skill-ref" data-ref="deity-name"></td>
              </tr>
              <tr class="magic-class-mage human-only">
                <td>Mage</td>
                <td>Arcane Casting</td>
                <td class="magic-skill-ref" data-ref="arcane-casting-percent"></td>
                <td>Arcane Knowledge</td>
                <td class="base-calc">INT x2</td>
                <td class="magic-skill-ref" data-ref="arcane-knowledge-percent"></td>
                <td></td>
              </tr>
              <tr class="magic-class-sorcerer human-only">
                <td>Sorcerer</td>
                <td>Arcane Sorcery</td>
                <td class="magic-skill-ref" data-ref="arcane-sorcery-percent"></td>
                <td>Sorcerous Wisdom</td>
                <td class="base-calc">CHA+INT</td>
                <td class="magic-skill-ref" data-ref="sorcerous-wisdom-percent"></td>
                <td></td>
              </tr>
              <tr class="magic-class-bard">
                <td>Bard</td>
                <td>Musicianship</td>
                <td class="magic-skill-ref" data-ref="musicianship-percent"></td>
                <td>Lyrical Magic</td>
                <td class="base-calc">CHA+POW</td>
                <td class="magic-skill-ref" data-ref="lyrical-magic-percent"></td>
                <td></td>
              </tr>
            </tbody>
          </table>
          <p class="syrin-note syrin-only">Syrin may not become Mages or Sorcerers</p>
        </section>

        <!-- Spell Lists -->
        <div class="spell-columns">
          <!-- Rank 3 Spells -->
          <section class="spell-column rank3">
            <h3 class="spell-rank-header">Rank 3 Spells</h3>
            <div class="memorize-count">
              May Memorize <input type="number" id="rank3-max" class="memorize-input" value="0"> Spells
            </div>
            <table class="spell-table">
              <thead>
                <tr>
                  <th class="col-memorized">M</th>
                  <th class="col-spell">Spell</th>
                  <th class="col-cost">Cost</th>
                </tr>
              </thead>
              <tbody id="rank3-body">
                <!-- Rank 3 spell rows generated dynamically -->
              </tbody>
            </table>
          </section>

          <!-- Rank 4 Spells -->
          <section class="spell-column rank4">
            <h3 class="spell-rank-header">Rank 4 Spells</h3>
            <div class="memorize-count">
              May Memorize <input type="number" id="rank4-max" class="memorize-input" value="0"> Spells
            </div>
            <table class="spell-table">
              <thead>
                <tr>
                  <th class="col-memorized">M</th>
                  <th class="col-spell">Spell</th>
                  <th class="col-cost">Cost</th>
                </tr>
              </thead>
              <tbody id="rank4-body">
                <!-- Rank 4 spell rows generated dynamically -->
              </tbody>
            </table>
          </section>

          <!-- Rank 5 Spells -->
          <section class="spell-column rank5">
            <h3 class="spell-rank-header">Rank 5 Spells</h3>
            <div class="memorize-count">
              May Memorize <input type="number" id="rank5-max" class="memorize-input" value="0"> Spells
            </div>
            <table class="spell-table">
              <thead>
                <tr>
                  <th class="col-memorized">M</th>
                  <th class="col-spell">Spell</th>
                  <th class="col-cost">Cost</th>
                </tr>
              </thead>
              <tbody id="rank5-body">
                <!-- Rank 5 spell rows generated dynamically -->
              </tbody>
            </table>
          </section>
        </div>
      </div>
    </section>

    <!-- ==================== PAGE 6: NOTES ==================== -->
    <section id="page-notes" class="sheet-page page-notes">
      <div class="page-content ornate-border">
        <h2 class="page-title">Notes</h2>
        <textarea id="general-notes" class="notes-textarea full-page" placeholder="General notes, backstory, campaign information..."></textarea>
      </div>
    </section>

  </div>

  <!-- Scripts -->
  <script src="js/data/skill-definitions.js"></script>
  <script src="js/calculations.js"></script>
  <script src="js/storage.js"></script>
  <script src="js/app.js"></script>
  <script>
    // Logout handler
    document.getElementById('btn-logout').addEventListener('click', function() {
      if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem('mythras_auth');
        window.location.href = 'index.html';
      }
    });
  </script>
</body>
</html>
